(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(t,e,n){t.exports=n(49)},39:function(t,e,n){},41:function(t,e,n){},49:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(24),o=n.n(c),u=n(4),i=(n(39),n(6)),s=n(7),l=n(9),d=n(8),p=n(10),f=(n(41),n(52)),m=n(51),h=n(54),v=n(53);var b=Object(u.b)(null,function(t,e){return{addProductToCart:function(){return t.cart.addProduct(e.product)}}})(function(t){var e=t.product,n=t.category,r=t.addProductToCart;return a.a.createElement("div",null,a.a.createElement(m.a,{to:"/products/".concat(e.id)},e.name," (",n?n.name:"\u0431\u0435\u0437 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457",")"),a.a.createElement("button",{onClick:r},"\u0432 \u043a\u043e\u0448\u0438\u043a"))}),y=function(t){var e=t.category;return a.a.createElement("div",null,a.a.createElement(m.a,{to:"/categories/".concat(e.id)},e.name))};function E(t){return t.items.reduce(function(t,e){return t+e.quantity},0)}function O(t,e){var n=t.items.reduce(function(t,e){var n=e.product,r=e.quantity;return t+n.price*r},0);return Number(n).toFixed(2)}var g=Object(u.b)(function(t){return{productsQuantity:E(t.cart),totalPrice:O(t.cart)}})(function(t){var e=t.productsQuantity,n=t.totalPrice;return a.a.createElement(m.a,{to:"/cart"},"\u041a\u043e\u0448\u0438\u043a (",e," \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0456\u0432 \u043d\u0430 \u0441\u0443\u043c\u0443 ",n," \u0433\u0440\u043d)")});function j(t,e){return e.find(function(e){return e.id===t.categoryId})}var k=function(t){function e(){return Object(i.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this.loadData(this.props)}},{key:"componentWillReceiveProps",value:function(t){t.match.url!==this.props.match.url&&this.loadData(t)}},{key:"loadData",value:function(t){if("/categories/:id"===t.match.path)var e={filter:{categoryId:t.match.params.id}};t.loadProducts(e),t.loadCategories()}},{key:"render",value:function(){var t=this;return a.a.createElement("div",null,a.a.createElement(g,null),a.a.createElement("h1",null,"Categories"),this.props.categories.map(function(t){return a.a.createElement(y,{key:t.id,category:t})}),a.a.createElement("h1",null,"Products Page ",this.props.products.length),this.props.products.map(function(e){return a.a.createElement(b,{key:e.id,product:e,category:j(e,t.props.categories)})}))}}]),e}(a.a.Component),w=Object(u.b)(function(t){return{products:t.products.list,categories:t.categories.list}},function(t){return{loadProducts:t.products.loadAll,loadCategories:t.categories.loadAll}})(k),P=function(t){var e=t.product;return a.a.createElement("div",null,a.a.createElement("h1",null,e.name),e.description)},C=function(t){function e(){return Object(i.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this.props.loadOne(this.props.match.params.id)}},{key:"render",value:function(){return this.props.product?a.a.createElement(P,{product:this.props.product}):"loading"}}]),e}(a.a.Component),x=Object(u.b)(function(t,e){return{product:t.products.list.find(function(t){return t.id===e.match.params.id})}},function(t){return{loadOne:t.products.loadOne}})(C);var q=Object(u.b)(null,function(t,e){var n=t.cart,r=e.quantity,a=e.product;return{addOne:function(){return n.setQuantity(a.id,r+1)},removeOne:function(){return n.setQuantity(a.id,r-1)},remove:function(){return n.removeProduct(a.id)}}})(function(t){var e=t.product,n=t.quantity,r=t.addOne,c=t.removeOne,o=t.remove;return a.a.createElement("div",null,a.a.createElement(m.a,{to:"/products/".concat(e.id)},e.name)," ",a.a.createElement("button",{onClick:c},"-1"),n,a.a.createElement("button",{onClick:r},"+1")," ",a.a.createElement("button",{onClick:o},"x"))}),I=function(t){function e(){return Object(i.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){var t=this.props,e=t.cartItems,n=t.productsQuantity,r=t.totalPrice;return a.a.createElement("div",null,a.a.createElement("h1",null,"Cart"),e.map(function(t){return a.a.createElement(q,{key:t.product.id,product:t.product,quantity:t.quantity})}),a.a.createElement("br",null),a.a.createElement("div",null,"\u0412 \u043a\u043e\u0440\u0437\u0438\u043d\u0456 ",n," \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0456\u0432 \u043d\u0430 \u0441\u0443\u043c\u0443 ",r," \u0433\u0440\u043d"))}}]),e}(a.a.Component),Q=Object(u.b)(function(t){var e=t.cart;return{cartItems:e.items,productsQuantity:E(e),totalPrice:O(e)}})(I),S=function(t){function e(){return Object(i.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return a.a.createElement(f.a,null,a.a.createElement("div",null,a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(m.a,{to:"/"},"Home"))),a.a.createElement(h.a,null,a.a.createElement(v.a,{path:"/cart",component:Q}),a.a.createElement(v.a,{path:"/products/:id",component:x}),a.a.createElement(v.a,{path:"/products",component:w}),a.a.createElement(v.a,{path:"/categories/:id",component:w}),a.a.createElement(v.a,{path:"/",component:w}))))}}]),e}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(50);var D=n(27),L=n(28),A=n.n(L),J=n(11),N=n.n(J),W=n(12),B=n(29),M=n.n(B),T="https://rest-api-broot.glitch.me/api/diana";function F(t){if(t.ok)return t;throw new Error("server error")}function H(t){return t.json()}function R(t,e){return fetch(t,e).then(F).then(H)}var $,z,G=($=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return R("".concat(T,"/products?").concat(M.a.stringify(t)))},z=function(t){return R("".concat(T,"/products/").concat(t))},{state:{list:[]},reducers:{setList:function(t,e){t.list=e}},effects:function(t){return{loadAll:function(){var t=Object(W.a)(N.a.mark(function t(e,n){var r;return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$(e);case 2:r=t.sent,this.setList(r);case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),loadOne:function(){var t=Object(W.a)(N.a.mark(function t(e,n){var r;return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(e);case 2:r=t.sent,this.setList([r]);case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}}});var K,U=(K=function(){return R("".concat(T,"/categories"))},{state:{list:[]},reducers:{setList:function(t,e){t.list=e}},effects:function(t){return{loadAll:function(){var t=Object(W.a)(N.a.mark(function t(e,n){var r;return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K();case 2:r=t.sent,this.setList(r);case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}}}),V={state:{items:[]},reducers:{addProduct:function(t,e){var n=t.items.find(function(t){return t.product.id===e.id});n?n.quantity+=1:t.items.push({product:e,quantity:1})},removeProduct:function(t,e){t.items=t.items.filter(function(t){return t.product.id!==e})},setQuantity:function(t,e,n){0===n?t.items=t.items.filter(function(t){return t.product.id!==e}):t.items.find(function(t){return t.product.id===e}).quantity=n}}},X="cart";var Y={products:G,categories:U,cart:V},Z=A()(),_=Object(D.init)({models:Y,plugins:[Z],redux:{initialState:{cart:function(){var t=localStorage.getItem(X);return JSON.parse(t)||V.state}()},middlewares:[function(t){return function(e){return function(n){console.log("dispatching",n);var r=e(n);return console.log("next state",t.getState()),r}}}]}});_.subscribe(function(){!function(t){var e=t.getState().cart;localStorage.setItem(X,JSON.stringify(e))}(_)}),window.store=_;var tt=_;o.a.render(a.a.createElement(u.a,{store:tt},a.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[30,2,1]]]);
//# sourceMappingURL=main.fd638892.chunk.js.map